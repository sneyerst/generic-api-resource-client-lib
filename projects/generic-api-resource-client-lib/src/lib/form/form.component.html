<div [formGroup]="_resourceFormGroup" class="form-group">

  <ng-container *ngFor="let formComponent of _resourceFormComponents">
    <mat-form-field *ngIf="formComponent.type == 'textfield'">
      <mat-label>{{formComponent.label}}</mat-label>
      <input matInput formControlName="{{formComponent.name}}">
    </mat-form-field>

    <mat-form-field *ngIf="formComponent.type == 'textarea'">
      <mat-label>{{formComponent.label}}</mat-label>
      <textarea matInput formControlName="{{formComponent.name}}"></textarea>
    </mat-form-field>

    <mat-checkbox *ngIf="formComponent.type == 'checkbox'"
                  [formControlName]="formComponent.name">{{formComponent.label}}</mat-checkbox>

    <mat-form-field *ngIf="formComponent.type == 'dropdown'">
      <mat-select placeholder="{{formComponent.label}}" formControlName="{{formComponent.name}}">
        <mat-option *ngFor="let option of formComponent.options" [value]="option.id">
          {{option.label}}
        </mat-option>
      </mat-select>
    </mat-form-field>

    <div *ngIf="formComponent.type == 'accordion'">
      <h2>{{formComponent.label}}</h2>
      <mat-accordion>

        <ng-container formArrayName="{{formComponent.name}}"
                      *ngFor="let item of getFormArray(_resourceFormGroup, formComponent.name).controls; let i = index;">
          <ng-container [formGroupName]="i">
            <mat-expansion-panel>
              <mat-expansion-panel-header>
                <span *ngIf="formComponent.children[i].trigger && item.value[formComponent.children[i].trigger]" style="text-decoration: line-through">{{formComponent.children[i].label}}</span>
                <span *ngIf="!formComponent.children[i].trigger || !item.value[formComponent.children[i].trigger]">{{formComponent.children[i].label}}</span>

              </mat-expansion-panel-header>

              <ng-container *ngFor="let childComponent of formComponent.children[i].fields">
                <mat-form-field *ngIf="childComponent.type == 'textarea'">
                  <mat-label>{{childComponent.label}}</mat-label>
                  <textarea matInput [formControlName]="childComponent.name"></textarea>
                </mat-form-field>

                <mat-checkbox *ngIf="childComponent.type == 'checkbox'" [formControlName]="childComponent.name">{{childComponent.label}}</mat-checkbox>

              </ng-container>

            </mat-expansion-panel>
          </ng-container>
        </ng-container>

      </mat-accordion>
    </div>


  </ng-container>

  <p class="detailActions">
    <button mat-raised-button color="primary" *ngIf="_resourceFormGroup.status == 'VALID'" (click)="updateResource()">
      Update
    </button>
    <button mat-raised-button color="secondary" (click)="cancelButtonClicked()">Cancel</button>
    <button mat-raised-button color="warn" *ngIf="_resourceFormGroup.status == 'VALID'" (click)="deleteResource()">
      Delete
    </button>
  </p>

</div>
